function [a, b, c, d] = make_tri(h, q, qd_i, qdd_i, qd_f, qdd_f)
n = numel(q);
a(1) = 0;
b(1) = 2*(h(1)+h(2))/h(2) + h(1)^2/h(2) * (1/h(1)+1/h(2));
c(1) = 1;
d(1) = 6/h(2) * (q(3)/h(2)+q(1)/h(1)) - 6/h(2) * (1/h(1)+1/h(2)) * (q(1)+h(1)*qd_i+h(1)^2/3*qdd_i) - h(1)/h(2)*qdd_i;
a(2) = h(2)/h(3) - h(1)^2/(h(2)*h(3));
b(2) = 2*(h(2)+h(3))/h(3);
c(2) = 1;
d(2) = 6/(h(2)*h(3)) * (q(1) + h(1)*qd_i + h(1)^2/3*qdd_i) + 6*q(4)/h(3)^2 - 6/h(3) * (1/h(2)+1/h(3)) *q(3);
for k = 3:n-4
    %i = k+1;
    a(k) = h(k)/h(k+1);
    b(k) = 2*(h(k)+h(k+1))/h(k+1);
    c(k) = 1;
    d(k) = 6/h(k+1) * ((q(k+2)-q(k+1))/h(k+1)-(q(k+1)-q(k))/h(k));
end
a(n-3) = h(n-3)/h(n-2);
b(n-3) = 2*(h(n-3)+h(n-2))/h(n-2);
c(n-3) = 1 - h(n-1)^2/h(n-2)^2;
d(n-3) = 6/h(n-2)^2 * (q(n) - qd_f*h(n-1) + h(n-1)^2/3*qdd_f) - 6/h(n-2) * (1/h(n-2)+1/h(n-3)) * q(n-2) + 6/(h(n-2)*h(n-3)) * q(n-3);
a(n-2) = h(n-2)/h(n-1);
b(n-2) = 2*(h(n-1)+h(n-2))/h(n-1)+(1/h(n-1)+1/h(n-2))*h(n-1);
c(n-2) = 0;
d(n-2) = -6/h(n-1)*(1/h(n-1)+1/h(n-2))*(q(n)-qd_f*h(n-1)+h(n-1)^2/3*qdd_f)+6*q(n)/h(n-1)^2+6*q(n-2)/(h(n-1)*h(n-2))-qdd_f;
end
